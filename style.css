/* Reset Básico */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent; /* Remove highlight azul no toque mobile */
}

html, body {
    height: 100%;
    overflow: hidden; /* Prevent body scroll */
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh; /* Full viewport height */
    transition: background-color 0.4s ease, color 0.4s ease, background-image 0.4s ease;
    background-repeat: no-repeat;
    background-attachment: fixed;
    background-size: cover;
    background-position: center;
    position: relative;
    background-color: var(--bg-primary);
    background-image: var(--theme-background-image);
}

/* Variáveis de Tema (Default: Claro) */
:root {
    --bg-primary: #ffffff;
    --bg-secondary: #f8f9fa;
    --bg-tertiary: #e9ecef;
    --bg-secondary-alpha: rgba(248, 249, 250, 0.98);
    --bg-tertiary-alpha: rgba(233, 236, 239, 0.96);
    --bg-sticky-alpha: rgba(248, 249, 250, 0.98);
    --bg-modal-alpha: #ffffff;
    --bg-notification: #4caf50; /* Green for notifications */
    --text-notification: #ffffff;

    --text-primary: #212529;
    --text-secondary: #6c757d;
    --accent-primary: #007bff;
    --accent-secondary: #6c757d;
    --accent-success: #28a745;
    --accent-danger: #dc3545;
    --accent-warning: #ffc107; /* Amarelo para FJ */
    --border-color: #dee2e6;
    --shadow-color: rgba(0, 0, 0, 0.1);
    --input-bg: #fff;
    --input-border: #ced4da;
    --nav-height: 65px;
    --fab-bottom-margin: 15px;
    --theme-background-image: none;
    --theme-background-opacity: 1;
    --theme-background-blend-mode: normal;
    --theme-background-filter: none;
     /* Grade Colors (Light) - Fallback if no custom ranges */
     --grade-low-bg: #f8d7da; --grade-low-text: #721c24;
     --grade-medium-bg: #fff3cd; --grade-medium-text: #856404;
     --grade-high-bg: #d4edda; --grade-high-text: #155724;
     /* Attendance Colors (Light) */
     --attendance-holiday-bg: #e2e3e5; --attendance-holiday-text: #495057; /* Non-school day */
     /* Classroom Map Colors */
     --map-seat-bg: var(--input-bg);
     --map-seat-border: var(--input-border);
     --map-seat-text: var(--text-secondary);
     --map-seat-occupied-bg: color-mix(in srgb, var(--accent-primary) 15%, transparent);
     --map-seat-occupied-text: var(--text-primary);
     --map-teacher-desk-bg: var(--bg-tertiary);
     --map-teacher-desk-border: var(--accent-secondary);
     --map-drag-over-bg: color-mix(in srgb, var(--accent-success) 30%, transparent);
     --map-seat-selected-border: var(--accent-warning);
     /* Teacher Desk Dimensions */
     --teacher-desk-width: 80px;
     --teacher-desk-height: 45px;
     --teacher-desk-border-width: 3px;
     /* Seat Dimensions */
     --seat-width: 65px;
     --seat-height: 45px;
     --seat-gap: 6px;
     /* Tools Grid */
     --tool-card-min-width: 130px;
     /* Calculator */
    --calc-display-bg: var(--bg-tertiary-alpha);
    --calc-button-bg: var(--accent-primary);
    --calc-button-text: #ffffff;
    --calc-op-button-bg: color-mix(in srgb, var(--accent-primary) 80%, #ffffff);
    --calc-util-button-bg: var(--accent-secondary);
    --calc-danger-button-bg: var(--accent-danger);
    --calc-warn-button-bg: var(--accent-warning);
    --calc-button-hover-opacity: 0.85;
    --calc-button-active-scale: 0.96;
    --calc-mode-button-bg: var(--bg-tertiary);
    --calc-mode-button-text: var(--text-secondary);
    --calc-mode-button-active-bg: var(--accent-primary);
    --calc-mode-button-active-text: #ffffff;
    /* Touch Feedback */
    --active-scale: 0.96;
    --active-opacity: 0.9;
}

/* Pseudo-elemento para background pattern com opacidade */
body::before { content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: var(--theme-background-image); background-color: transparent; background-repeat: repeat; background-attachment: fixed; background-size: auto; background-position: center; opacity: var(--theme-background-opacity); mix-blend-mode: var(--theme-background-blend-mode); filter: var(--theme-background-filter); z-index: -1; pointer-events: none; transition: opacity 0.4s ease; }

/* --- TEMAS --- */
 body.theme-light { --bg-secondary-alpha: var(--bg-secondary); --bg-tertiary-alpha: var(--bg-tertiary); --bg-sticky-alpha: var(--bg-secondary); --bg-modal-alpha: var(--bg-primary); --theme-background-image: none; --theme-background-opacity: 0; --grade-low-bg: #f8d7da; --grade-low-text: #721c24; --grade-medium-bg: #fff3cd; --grade-medium-text: #856404; --grade-high-bg: #d4edda; --grade-high-text: #155724; --attendance-holiday-bg: #e2e3e5; --attendance-holiday-text: #495057; --bg-notification: #4caf50; --text-notification: #ffffff; }
 body.theme-light button.absent.justified.selected { color: var(--text-primary); }
 body.theme-light .monthly-attendance-table td.status-F { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
 body.theme-light .monthly-attendance-table td.status-FJ { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
 body.theme-light .monthly-attendance-table td.status-P { background-color: var(--grade-high-bg); color: var(--grade-high-text); }
 body.theme-light .monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; }
 body.theme-light .seat-placeholder-text { color: var(--map-seat-text); }
 body.theme-light .calculator-buttons button.op { background-color: #6c757d; color: #fff; }
 body.theme-light .calculator-buttons button.util { background-color: #adb5bd; color: var(--text-primary); }
 body.theme-light .calculator-buttons button.danger { background-color: #dc3545; color: #fff; }
 body.theme-light .calculator-buttons button.warn { background-color: #ffc107; color: var(--text-primary); }
 body.theme-light .calculator-buttons button.eq { background-color: #28a745; color: #fff; }
 body.theme-light .calculator-modal .pairs-list { background-color: var(--bg-tertiary-alpha); }
 body.theme-light .calculator-modal .pair-item { background-color: var(--bg-secondary-alpha); }
body.theme-dark { --bg-primary: #212529; --bg-secondary: #343a40; --bg-tertiary: #495057; --bg-secondary-alpha: var(--bg-secondary); --bg-tertiary-alpha: var(--bg-tertiary); --bg-sticky-alpha: var(--bg-secondary); --bg-modal-alpha: #2c3034; --text-primary: #f8f9fa; --text-secondary: #adb5bd; --accent-primary: #3b82f6; --accent-secondary: #6b7280; --accent-success: #22c55e; --accent-danger: #ef4444; --accent-warning: #f59e0b; --border-color: #4b5563; --shadow-color: rgba(255, 255, 255, 0.08); --input-bg: #374151; --input-border: #4b5563; --theme-background-image: none; --theme-background-opacity: 0; --grade-low-bg: color-mix(in srgb, var(--accent-danger) 25%, transparent); --grade-low-text: #f8f9fa; --grade-medium-bg: color-mix(in srgb, var(--accent-warning) 30%, transparent); --grade-medium-text: #111827; --grade-high-bg: color-mix(in srgb, var(--accent-success) 25%, transparent); --grade-high-text: #f8f9fa; --attendance-holiday-bg: #495057; --attendance-holiday-text: #ced4da; --bg-notification: #22c55e; --text-notification: #111827; --map-seat-bg: var(--input-bg); --map-seat-border: var(--input-border); --map-seat-text: var(--text-secondary); --map-seat-occupied-bg: color-mix(in srgb, var(--accent-primary) 20%, transparent); --map-seat-occupied-text: var(--text-primary); --map-teacher-desk-bg: var(--bg-tertiary); --map-teacher-desk-border: var(--accent-secondary); --map-drag-over-bg: color-mix(in srgb, var(--accent-success) 35%, transparent); --map-seat-selected-border: var(--accent-warning); --calc-button-bg: var(--accent-primary); --calc-button-text: #ffffff; --calc-op-button-bg: color-mix(in srgb, var(--accent-primary) 70%, #000000); --calc-util-button-bg: var(--accent-secondary); --calc-danger-button-bg: var(--accent-danger); --calc-warn-button-bg: var(--accent-warning); --calc-mode-button-bg: var(--bg-tertiary); --calc-mode-button-text: var(--text-secondary); --calc-mode-button-active-bg: var(--accent-primary); --calc-mode-button-active-text: #ffffff; }
 body.theme-dark button.warning { color: #111827; }
 body.theme-dark button.absent.justified.selected { color: #111827; }
 body.theme-dark .monthly-attendance-table td.status-F { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
 body.theme-dark .monthly-attendance-table td.status-FJ { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
 body.theme-dark .monthly-attendance-table td.status-P { background-color: var(--grade-high-bg); color: var(--grade-high-text); }
 body.theme-dark .monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; }
 body.theme-dark .seat-placeholder-text { color: var(--map-seat-text); }
 body.theme-dark .calculator-buttons button.warn { color: var(--text-primary); }
 body.theme-dark .calculator-modal .pairs-list { background-color: var(--bg-tertiary-alpha); }
 body.theme-dark .calculator-modal .pair-item { background-color: var(--bg-secondary-alpha); border-color: var(--input-border); }
body.theme-forest-green { --bg-primary: #f0fff4; --bg-secondary: #dff1e5; --bg-tertiary: #c8e6d1; --bg-secondary-alpha: var(--bg-secondary); --bg-tertiary-alpha: var(--bg-tertiary); --bg-sticky-alpha: var(--bg-secondary); --bg-modal-alpha: #e8f5e9; --text-primary: #1e3a1f; --text-secondary: #4a7c59; --accent-primary: #588157; --accent-secondary: #3a5a40; --accent-warning: #e9c46a; --border-color: #a3c9a8; --shadow-color: rgba(58, 90, 64, 0.15); --input-bg: #ffffff; --input-border: #a3c9a8; --theme-background-image: none; --theme-background-opacity: 0; --grade-low-bg: #f1dede; --grade-low-text: #a94442; --grade-medium-bg: #faf2cc; --grade-medium-text: #8a6d3b; --grade-high-bg: #dff1e5; --grade-high-text: #3c763d; --attendance-holiday-bg: #d1e7dd; --attendance-holiday-text: #4a7c59; --bg-notification: #588157; --text-notification: #ffffff; --map-seat-bg: var(--input-bg); --map-seat-border: var(--input-border); --map-seat-text: var(--text-secondary); --map-seat-occupied-bg: color-mix(in srgb, var(--accent-primary) 15%, transparent); --map-seat-occupied-text: var(--text-primary); --map-teacher-desk-bg: var(--bg-tertiary); --map-teacher-desk-border: var(--accent-secondary); --map-drag-over-bg: color-mix(in srgb, var(--accent-success) 30%, transparent); --map-seat-selected-border: var(--accent-warning); --calc-button-bg: var(--accent-primary); --calc-button-text: #ffffff; --calc-op-button-bg: color-mix(in srgb, var(--accent-primary) 85%, #ffffff); --calc-util-button-bg: var(--accent-secondary); --calc-danger-button-bg: #c1666b; --calc-warn-button-bg: var(--accent-warning); --calc-mode-button-bg: var(--bg-tertiary); --calc-mode-button-text: var(--text-secondary); --calc-mode-button-active-bg: var(--accent-primary); --calc-mode-button-active-text: #ffffff; }
 body.theme-forest-green button.warning { color: var(--text-primary); }
 body.theme-forest-green button.absent.justified.selected { color: var(--text-primary); }
 body.theme-forest-green .monthly-attendance-table td.status-F { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
 body.theme-forest-green .monthly-attendance-table td.status-FJ { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
 body.theme-forest-green .monthly-attendance-table td.status-P { background-color: var(--grade-high-bg); color: var(--grade-high-text); }
 body.theme-forest-green .monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; }
 body.theme-forest-green .seat-placeholder-text { color: var(--map-seat-text); }
 body.theme-forest-green .calculator-buttons button.warn { color: var(--text-primary); }
 body.theme-forest-green .calculator-modal .pairs-list { background-color: var(--bg-tertiary-alpha); }
 body.theme-forest-green .calculator-modal .pair-item { background-color: var(--bg-secondary-alpha); border-color: var(--input-border); }
body.theme-math-master { --bg-primary: #e0f7ff; --bg-secondary: #ccecf7; --bg-tertiary: #b8e5f0; --bg-secondary-alpha: rgba(204, 236, 247, 0.96); --bg-tertiary-alpha: rgba(184, 229, 240, 0.94); --bg-sticky-alpha: rgba(204, 236, 247, 0.98); --bg-modal-alpha: #e0f7ff; --text-primary: #00405a; --text-secondary: #40788c; --accent-primary: #006688; --accent-secondary: #5a9cb0; --accent-warning: #fca311; --border-color: #a8d8e6; --input-bg: #ffffff; --input-border: #8fc5d6; --theme-background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'%3E%3Cstyle%3E text %7B fill: %23006688; opacity: 0.06; font-weight: 500; font-family: 'Cambria Math', 'Latin Modern Math', serif; %7D path, line %7B stroke: %23006688; opacity: 0.05; stroke-width: 1px; fill: none; %7D %3C/style%3E%3Ctext x='15' y='40' font-size='18' transform='rotate(-12 15,40)'%3Eƒ(x)%3C/text%3E%3Ctext x='100' y='30' font-size='22'%3E∑%3C/text%3E%3Cpath d='M 70 60 q 20 25 40 0 t 40 0' stroke-dasharray='3 3'/%3E%3Ctext x='30' y='110' font-size='20'%3E∫%3C/text%3E%3Cpath d='M 110 80 c -15 15 -15 40 0 55' /%3E%3Ctext x='130' y='145' font-size='16'%3E2πr%3C/text%3E%3Ctext x='60' y='135' font-size='24'%3E±%3C/text%3E%3Cline x1='10' y1='140' x2='40' y2='150'/%3E%3C/svg%3E"); --theme-background-opacity: 1; --theme-background-blend-mode: overlay; --theme-background-filter: grayscale(10%); --grade-low-bg: #f8d7da; --grade-low-text: #721c24; --grade-medium-bg: #fff3cd; --grade-medium-text: #856404; --grade-high-bg: #d4edda; --grade-high-text: #155724; --attendance-holiday-bg: #b8e5f0; --attendance-holiday-text: #00405a; --bg-notification: #006688; --text-notification: #ffffff; --map-seat-bg: var(--input-bg); --map-seat-border: var(--input-border); --map-seat-text: var(--text-secondary); --map-seat-occupied-bg: color-mix(in srgb, var(--accent-primary) 15%, transparent); --map-seat-occupied-text: var(--text-primary); --map-teacher-desk-bg: var(--bg-tertiary); --map-teacher-desk-border: var(--accent-secondary); --map-drag-over-bg: color-mix(in srgb, var(--accent-success) 30%, transparent); --map-seat-selected-border: var(--accent-warning); --calc-button-bg: #0077a0; --calc-button-text: #ffffff; --calc-op-button-bg: #005577; --calc-util-button-bg: var(--accent-secondary); --calc-danger-button-bg: #d9534f; --calc-warn-button-bg: var(--accent-warning); --calc-mode-button-bg: var(--bg-tertiary); --calc-mode-button-text: var(--text-secondary); --calc-mode-button-active-bg: var(--accent-primary); --calc-mode-button-active-text: #ffffff; }
 body.theme-math-master button.warning { color: var(--text-primary); }
 body.theme-math-master button.absent.justified.selected { color: #fff; } /* Era var(--text-primary), ajuste específico */
 body.theme-math-master .monthly-attendance-table td.status-F { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
 body.theme-math-master .monthly-attendance-table td.status-FJ { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
 body.theme-math-master .monthly-attendance-table td.status-P { background-color: var(--grade-high-bg); color: var(--grade-high-text); }
 body.theme-math-master .monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; }
 body.theme-math-master .seat-placeholder-text { color: var(--map-seat-text); }
 body.theme-math-master .calculator-buttons button.warn { color: var(--text-primary); }
 body.theme-math-master .calculator-modal .pairs-list { background-color: var(--bg-tertiary-alpha); }
 body.theme-math-master .calculator-modal .pair-item { background-color: var(--bg-secondary-alpha); border-color: var(--input-border); }
body.theme-historic-scroll { --bg-primary: #fdf6e3; --bg-secondary: #f5efdc; --bg-tertiary: #ebe3cd; --bg-secondary-alpha: rgba(245, 239, 220, 0.97); --bg-tertiary-alpha: rgba(235, 227, 205, 0.96); --bg-sticky-alpha: rgba(245, 239, 220, 0.98); --bg-modal-alpha: #fdf6e3; --text-primary: #654b28; --text-secondary: #8c785e; --accent-primary: #8b4513; --accent-secondary: #a0522d; --accent-warning: #d4a373; --border-color: #d2b48c; --input-bg: #fffaf0; --input-border: #deb887; --theme-background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180' viewBox='0 0 180 180'%3E%3Cstyle%3E text %7B fill: %238b4513; opacity: 0.08; font-family: 'Segoe UI Symbol', sans-serif; %7D path %7B stroke: %238b4513; opacity: 0.07; stroke-width: 0.7px; fill: none; %7D %3C/style%3E%3Ctext x='20' y='45' font-size='30'%3E𓂀%3C/text%3E %3C!-- Eye of Horus --%3E%3Ctext x='120' y='35' font-size='26'%3E𓆗%3C/text%3E %3C!-- Cobra --%3E%3Cpath d='M 60 70 h 50 v 15 h -50 z' /%3E%3Ctext x='30' y='120' font-size='28'%3E𓅊%3C/text%3E %3C!-- Bird --%3E%3Cpath d='M 100 90 l 25 50 l -50 0 z' /%3E%3Ctext x='130' y='150' font-size='24'%3E𓍑%3C/text%3E%3C!-- Staff --%3E%3Ctext x='70' y='140' font-size='22'%3E🏺%3C/text%3E%3C/svg%3E"); --theme-background-opacity: 1; --theme-background-blend-mode: multiply; --theme-background-filter: sepia(25%); --grade-low-bg: #f1dede; --grade-low-text: #a94442; --grade-medium-bg: #faf2cc; --grade-medium-text: #8a6d3b; --grade-high-bg: #dff1e5; --grade-high-text: #3c763d; --attendance-holiday-bg: #ebe3cd; --attendance-holiday-text: #654b28; --bg-notification: #8b4513; --text-notification: #fdf6e3; --map-seat-bg: var(--input-bg); --map-seat-border: var(--input-border); --map-seat-text: var(--text-secondary); --map-seat-occupied-bg: color-mix(in srgb, var(--accent-primary) 15%, transparent); --map-seat-occupied-text: var(--text-primary); --map-teacher-desk-bg: var(--bg-tertiary); --map-teacher-desk-border: var(--accent-secondary); --map-drag-over-bg: color-mix(in srgb, var(--accent-success) 30%, transparent); --map-seat-selected-border: var(--accent-warning); --calc-button-bg: var(--accent-primary); --calc-button-text: #fdf6e3; --calc-op-button-bg: var(--accent-secondary); --calc-util-button-bg: #b08968; --calc-danger-button-bg: #ae2012; --calc-warn-button-bg: var(--accent-warning); --calc-mode-button-bg: var(--bg-tertiary); --calc-mode-button-text: var(--text-secondary); --calc-mode-button-active-bg: var(--accent-primary); --calc-mode-button-active-text: #fdf6e3; }
 body.theme-historic-scroll button.warning { color: var(--text-primary); }
 body.theme-historic-scroll button.absent.justified.selected { color: var(--text-primary); }
 body.theme-historic-scroll .monthly-attendance-table td.status-F { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
 body.theme-historic-scroll .monthly-attendance-table td.status-FJ { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
 body.theme-historic-scroll .monthly-attendance-table td.status-P { background-color: var(--grade-high-bg); color: var(--grade-high-text); }
 body.theme-historic-scroll .monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; }
 body.theme-historic-scroll .seat-placeholder-text { color: var(--map-seat-text); }
 body.theme-historic-scroll .calculator-buttons button.warn { color: var(--text-primary); }
 body.theme-historic-scroll .calculator-modal .pairs-list { background-color: var(--bg-tertiary-alpha); }
 body.theme-historic-scroll .calculator-modal .pair-item { background-color: var(--bg-secondary-alpha); border-color: var(--input-border); }
body.theme-alchemist { --bg-primary: #2a2a3e; --bg-secondary: #3a3a52; --bg-tertiary: #4a4a66; --bg-secondary-alpha: rgba(58, 58, 82, 0.97); --bg-tertiary-alpha: rgba(74, 74, 102, 0.95); --bg-sticky-alpha: rgba(58, 58, 82, 0.98); --bg-modal-alpha: #2a2a3e; --text-primary: #e0e0ff; --text-secondary: #a0a0cc; --accent-primary: #ffd700; --accent-secondary: #c0c0c0; --accent-success: #32cd32; --accent-danger: #dc143c; --accent-warning: #ff8c00; --border-color: #5a5a7a; --shadow-color: rgba(0, 0, 0, 0.25); --input-bg: #4a4a66; --input-border: #6a6a8a; --theme-background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'%3E%3Cstyle%3E text %7B fill: %23ffd700; opacity: 0.07; font-size: 24px; %7D path, circle %7B stroke: %23ffd700; opacity: 0.06; stroke-width: 0.8px; fill: none; %7D %3C/style%3E%3Ctext x='20' y='45'%3E☉%3C/text%3E%3Ccircle cx='95' cy='35' r='12'/%3E%3Cpath d='M 90 35 h 10 M 95 30 v 10'/%3E%3Ctext x='30' y='110' font-size='28'%3E△%3C/text%3E%3Cpath d='M 70 85 l 40 0 l -20 35 z' transform='rotate(180 90 102.5)'/%3E%3Ctext x='120' y='135' font-size='20'%3E♃%3C/text%3E%3Ctext x='65' y='70' font-size='28'%3E☾%3C/text%3E%3Ctext x='100' y='80' font-size='22'%3E⚕%3C/text%3E%3C/svg%3E"); --theme-background-opacity: 1; --theme-background-blend-mode: overlay; --grade-low-bg: color-mix(in srgb, var(--accent-danger) 25%, transparent); --grade-low-text: #f8f9fa; --grade-medium-bg: color-mix(in srgb, var(--accent-warning) 30%, transparent); --grade-medium-text: #1a1a2e; --grade-high-bg: color-mix(in srgb, var(--accent-success) 25%, transparent); --grade-high-text: #f8f9fa; --attendance-holiday-bg: #4a4a66; --attendance-holiday-text: #a0a0cc; --bg-notification: #ffd700; --text-notification: #2a2a3e; --map-seat-bg: var(--input-bg); --map-seat-border: var(--input-border); --map-seat-text: var(--text-secondary); --map-seat-occupied-bg: color-mix(in srgb, var(--accent-primary) 20%, transparent); --map-seat-occupied-text: var(--text-primary); --map-teacher-desk-bg: var(--bg-tertiary); --map-teacher-desk-border: var(--accent-secondary); --map-drag-over-bg: color-mix(in srgb, var(--accent-success) 35%, transparent); --map-seat-selected-border: var(--accent-warning); --calc-button-bg: #6a6a8a; --calc-button-text: #e0e0ff; --calc-op-button-bg: #5a5a7a; --calc-util-button-bg: var(--accent-secondary); --calc-danger-button-bg: var(--accent-danger); --calc-warn-button-bg: var(--accent-warning); --calc-mode-button-bg: var(--bg-tertiary); --calc-mode-button-text: var(--text-secondary); --calc-mode-button-active-bg: var(--accent-primary); --calc-mode-button-active-text: #2a2a3e; }
 body.theme-alchemist button.warning { color: #1a1a2e; }
 body.theme-alchemist button.absent.justified.selected { color: #1a1a2e; }
 body.theme-alchemist .monthly-attendance-table td.status-F { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
 body.theme-alchemist .monthly-attendance-table td.status-FJ { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
 body.theme-alchemist .monthly-attendance-table td.status-P { background-color: var(--grade-high-bg); color: var(--grade-high-text); }
 body.theme-alchemist .monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; }
 body.theme-alchemist .seat-placeholder-text { color: var(--map-seat-text); }
 body.theme-alchemist .calculator-buttons button.warn { color: var(--text-primary); } /* Era #1a1a2e, revertendo para contraste melhor no darkish */
 body.theme-alchemist .calculator-modal .pairs-list { background-color: var(--bg-tertiary-alpha); }
 body.theme-alchemist .calculator-modal .pair-item { background-color: var(--bg-secondary-alpha); border-color: var(--input-border); }
 body.theme-alchemist .calculator-buttons button.num,
 body.theme-alchemist .calculator-buttons button.op,
 body.theme-alchemist .calculator-buttons button.util,
 body.theme-alchemist .calculator-buttons button.eq { color: var(--text-primary); }
 body.theme-alchemist .calculator-buttons button.warn { color: #1a1a2e; } /* Manter escuro para o botão warn */
/* --- FIM TEMAS --- */

/* Estilos Gerais, Layout Principal, Seções, Cards, Listas, Modal, Tabelas */
body { background-color: var(--bg-primary); color: var(--text-primary); }
h1, h2, h3, h4, h5, h6 { color: var(--text-primary); margin-bottom: 0.75rem; font-weight: 600; }
h2 { text-align: center; width: 100%; margin-top: 0.5rem; margin-bottom: 1rem; display: flex; align-items: center; justify-content: center; gap: 0.5em; }
p { color: var(--text-secondary); line-height: 1.6; margin-bottom: 1rem; }
a { color: var(--accent-primary); text-decoration: none; transition: color 0.2s ease; }
a:hover { color: var(--accent-secondary); text-decoration: underline; }
button, .button-like { padding: 0.6rem 1.2rem; border: none; border-radius: 5px; cursor: pointer; font-size: 0.95rem; font-weight: 500; transition: background-color 0.2s ease, transform 0.15s cubic-bezier(0.2, 0, 0.38, 0.9), opacity 0.2s ease; background-color: var(--accent-primary); color: #fff; margin: 0.25rem; display: inline-flex; align-items: center; justify-content: center; text-align: center; vertical-align: middle; line-height: 1.4; user-select: none; /* Prevent text selection */ }
button:hover, .button-like:hover { opacity: 0.85; }
button:active, .button-like:active { transform: scale(var(--active-scale)); opacity: var(--active-opacity); }
button:disabled, .button-like:disabled { opacity: 0.6; cursor: not-allowed; background-color: var(--accent-secondary); }
form button:not([type="submit"]) { type: button; }
button.secondary, .button-like.secondary { background-color: var(--accent-secondary); color: #fff; }
button.danger, .button-like.danger { background-color: var(--accent-danger); color: #fff; }
button.success, .button-like.success { background-color: var(--accent-success); color: #fff; }
button.warning, .button-like.warning { background-color: var(--accent-warning); color: var(--text-primary); }
button.icon-button, .button-like.icon-button { padding: 0.4rem; font-size: 1.1rem; line-height: 1; background-color: transparent; color: var(--text-secondary); border: 1px solid var(--border-color); border-radius: 5px; margin: 0 2px; }
button.icon-button:hover, .button-like.icon-button:hover { color: var(--accent-primary); background-color: var(--bg-tertiary-alpha); border-color: var(--accent-primary); }
button.icon-button:active, .button-like.icon-button:active { transform: scale(0.92); opacity: 1; background-color: color-mix(in srgb, var(--bg-tertiary-alpha) 80%, black); }
button.icon-button:disabled { background-color: transparent; border-color: var(--border-color); color: var(--text-secondary); opacity: 0.5; }
input[type="text"], input[type="time"], input[type="number"], input[type="date"], select, textarea, input[type="search"], input[type="color"] { width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid var(--input-border); border-radius: 5px; background-color: var(--input-bg); color: var(--text-primary); font-size: 1rem; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
input[type="color"] { padding: 0.2rem; height: 40px; width: 50px; vertical-align: middle; cursor: pointer;}
input:focus, select:focus, textarea:focus, input[type="search"]:focus, input[type="color"]:focus { outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-primary) 20%, transparent); }
input[type="checkbox"] { width: auto; margin-bottom: 0; margin-right: 5px; vertical-align: middle; }
textarea { min-height: 100px; resize: vertical; }
label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-secondary); }
label[for*="checkbox"], label[for*="radio"] { display: inline; font-weight: normal; margin-bottom: 0; }
.form-group { margin-bottom: 1rem; }
.checkbox-group { margin-bottom: 0.5rem; padding: 5px 0; display: flex; align-items: center;}
.app-header { background-color: var(--bg-secondary-alpha); padding: 0.6rem 1rem; border-bottom: 1px solid var(--border-color); box-shadow: 0 2px 4px var(--shadow-color); position: sticky; top: 0; z-index: 1000; flex-shrink: 0; transition: background-color 0.4s ease; display: flex; flex-direction: column; gap: 0.5rem; }
.header-top-row { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: 0.8rem; min-height: 2em; }
.app-header h1 { margin: 0; font-size: 1.3rem; color: var(--accent-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-shrink: 1; min-width: 0; flex-basis: auto; }
.header-info { font-size: 0.8rem; color: var(--text-secondary); text-align: right; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-shrink: 1; min-width: 0; margin-left: auto; padding-left: 10px; }
#search-input { width: 100%; margin: 0; padding: 0.4rem 0.8rem; font-size: 0.9rem; margin-bottom: 0; }
.app-content { flex-grow: 1; overflow-y: auto; padding: 1rem; background-color: transparent; -webkit-overflow-scrolling: touch; padding-bottom: calc(var(--nav-height) + 10px); }
.app-nav { background-color: var(--bg-secondary-alpha); padding: 0.4rem 0; display: flex; justify-content: space-around; align-items: stretch; border-top: 1px solid var(--border-color); position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000; flex-shrink: 0; height: var(--nav-height); box-shadow: 0 -2px 5px var(--shadow-color); transition: background-color 0.4s ease; }
/* Ajuste para 7 botões */
.nav-button { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 0.7rem; /* Reduzido */ text-align: center; padding: 0.4rem 0.2rem; /* Reduzido padding horizontal */ display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; height: 100%; border-radius: 0; transition: background-color 0.25s ease, color 0.25s ease, transform 0.1s ease; overflow: hidden; }
.nav-button .icon { font-size: 1.3rem; /* Levemente reduzido */ margin-bottom: 0.1rem; }
.nav-button span:not(.icon) { white-space: nowrap; /* Garante que fique em uma linha */ }
.nav-button.active { color: var(--accent-primary); background-color: var(--bg-tertiary-alpha); }
.nav-button:hover:not(.active) { background-color: var(--bg-tertiary-alpha); }
.nav-button:active { transform: scale(0.95); } /* Feedback de toque */
.nav-button:disabled { opacity: 0.5; cursor: not-allowed; background-color: transparent !important; }
.section { display: none; animation: fadeIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
.section.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.card { background-color: var(--bg-secondary-alpha); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; box-shadow: 0 2px 5px var(--shadow-color); transition: box-shadow 0.3s ease, background-color 0.4s ease, padding-bottom 0.3s ease; }
.card:hover { box-shadow: 0 5px 12px color-mix(in srgb, var(--shadow-color) 150%, black); }
.card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); flex-wrap: wrap; gap: 5px; }
.card-header h3 { margin: 0; font-size: 1.1rem; flex-basis: calc(100% - 50px); margin-bottom: 5px; display: flex; align-items: center; gap: 0.5em; margin-top: 0.1rem; }
.card-header .options { display: flex; align-items: center; flex-wrap: wrap; gap: 5px; margin-left: auto; flex-shrink: 0; }
.card-actions button, .card-actions .button-like { margin-left: 0.3rem; padding: 0.3rem 0.6rem; font-size: 0.85rem; }
.card-content { padding-top: 0.5rem; transition: opacity 0.3s ease, max-height 0.4s ease-out; max-height: 1500px; /* Default alto */ overflow: hidden; opacity: 1; }
 /* Remover max-height específico do student list */
#student-list-container.card-content {
    max-height: none; /* Permite que cresça */
}
.card-toggle-button { padding: 0.3rem !important; font-size: 0.9rem !important; line-height: 1; background: transparent !important; border: none !important; color: var(--text-secondary); cursor: pointer; margin-left: auto; order: 99; margin-top: 0.1rem; }
.card-toggle-button:hover { color: var(--accent-primary); }
.card.collapsed { padding-bottom: 0.5rem; }
.card.collapsed .card-content { max-height: 0; opacity: 0; padding-top: 0; margin-top: -1px; border-top: none; visibility: hidden; }
.card.collapsed .card-header { border-bottom: none; margin-bottom: 0; }
.item-list { list-style: none; padding: 0; }

/* --- ESTILOS GERAIS DO LIST ITEM (Restaurado) --- */
.list-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* Original: alinha itens ao topo */
    padding: 0.75rem 1rem;
    background-color: var(--bg-secondary-alpha);
    border: 1px solid var(--border-color);
    border-radius: 5px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: background-color 0.25s ease, transform 0.15s ease;
    flex-direction: row; /* Layout lado a lado */
}
 .list-item:hover { background-color: var(--bg-tertiary-alpha); }
 .list-item:active { transform: scale(0.98); background-color: var(--bg-tertiary-alpha); }

.list-item .item-info {
    flex-grow: 1;
    margin-right: 1rem; /* Espaço original */
    overflow: hidden;
    text-overflow: ellipsis;
}
.list-item .item-info p { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.list-item .item-info h4 { margin-bottom: 0.2rem; font-size: 1rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

.list-item-actions {
    flex-shrink: 0;
    display: flex;
    gap: 3px;
    align-self: flex-start; /* Alinha botões ao topo */
}
.list-item-actions button, .list-item-actions .button-like { margin-left: 0; padding: 0.3rem; font-size: 1rem; }

 /* Aluno específico (restaurado para layout original lado a lado) */
 #student-list-container .list-item {
     align-items: center; /* Centraliza verticalmente no item de aluno */
     cursor: default; /* Itens de aluno não são clicáveis por padrão */
 }
  #student-list-container .list-item:active {
     transform: none; /* Desativa efeito de clique no item de aluno */
 }
 #student-list-container .list-item .student-number {
     font-weight: bold; margin-right: 10px; min-width: 30px; text-align: right;
 }
  #student-list-container .list-item .student-name {
     white-space: normal; word-break: break-word; flex-grow: 1; margin-right: 10px;
 }
 #student-list-container .list-item .list-item-actions {
    align-self: center; /* Centraliza os botões do aluno verticalmente */
    margin-left: auto; /* Empurra para a direita */
 }


/* --- ESTILOS ESPECÍFICOS PARA SCHOOL ITEM (Com Footer) --- */
.list-item.school-item {
    display: flex; /* Mantém flex */
    flex-direction: column; /* Muda para coluna */
    align-items: stretch; /* Estica filhos */
    padding-bottom: 0.5rem; /* Espaço extra para o quorum */
    gap: 0.75rem; /* Espaço entre linha principal e quorum */
}
/* Linha Principal: Nome e Botões */
.school-item-main-row {
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* Alinha ao topo como original */
    width: 100%;
}
.school-item .item-info { /* Container do nome */
    flex-grow: 1;
    margin-right: 10px;
    overflow: hidden;
}
.school-item .item-info h4 {
     margin-bottom: 0; /* Sem margem abaixo do nome */
     white-space: normal;
     word-break: break-word;
}
.school-item .list-item-actions {
    flex-shrink: 0;
    display: flex;
    gap: 5px;
    align-self: flex-start; /* Alinha botões ao topo */
}
 .school-item .list-item-actions .button-like { /* Botão "Turmas" */
    padding: 0.5rem 0.8rem;
    font-size: 0.9rem;
 }
 .school-item .list-item-actions .icon-button { /* Botões Editar/Excluir */
    padding: 0.4rem;
    font-size: 1rem;
 }

/* Linha Inferior: Quórum */
.school-quorum-info {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-wrap: wrap;
    padding-top: 0.6rem;
    border-top: 1px dashed var(--border-color);
    margin-top: 0; /* Removido margin-top, controlado pelo gap do pai */
    width: 100%;
}
.school-quorum-info label {
     margin-bottom: 0;
     font-size: 0.75rem; /* Fonte ainda menor */
     color: var(--text-secondary);
     white-space: nowrap;
     margin-right: 1px;
}
.school-quorum-info input[type="date"],
.school-quorum-info select {
     padding: 0.15rem 0.3rem; /* Padding mínimo */
     font-size: 0.75rem; /* Fonte menor */
     margin-bottom: 0;
     width: auto;
     flex-grow: 0;
     flex-shrink: 1;
     border-radius: 3px;
     border: 1px solid var(--input-border);
     background-color: var(--input-bg);
     color: var(--text-primary);
     cursor: pointer;
     height: auto;
     line-height: 1.1; /* Ajuste fino */
     vertical-align: middle;
}
.school-quorum-info input[type="date"] {
    max-width: 110px;
}
.school-quorum-info select {
    max-width: 85px;
}
 .school-quorum-info .quorum-display {
    font-weight: bold;
    font-size: 0.8rem; /* Fonte menor */
    color: var(--accent-success);
    margin-left: auto;
    padding-left: 6px;
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    gap: 0.25em; /* Espaço ícone-texto menor */
 }
  .school-quorum-info .quorum-display::before {
      content: "📊";
      font-size: 0.9em;
      display: inline-block;
  }
 .quorum-display.no-data {
     color: var(--accent-danger);
     opacity: 0.8;
 }
 .quorum-display.no-data::before {
    opacity: 0.6;
 }
 /* --- FIM CSS QUÓRUM --- */

.search-result-item .item-info { margin-right: 0.5rem; }
.search-result-item .result-type { font-size: 0.75rem; color: var(--text-secondary); background-color: var(--bg-tertiary); padding: 0.1rem 0.4rem; border-radius: 3px; margin-left: auto; flex-shrink: 0; }

.modal { display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; overflow: hidden; background-color: rgba(0,0,0,0.6); align-items: center; justify-content: center; animation: modalFadeIn 0.3s ease-out; }
.modal.show { display: flex; }
.modal-content { background-color: var(--bg-modal-alpha); margin: auto; padding: 15px; border: 1px solid var(--border-color); border-radius: 10px; width: 95%; max-width: 600px; max-height: 90vh; display: flex; flex-direction: column; box-shadow: 0 8px 25px var(--shadow-color); animation: modalSlideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94); transition: background-color 0.4s ease; }
 .monthly-attendance-modal .modal-content { max-width: 95%; width: auto; }
 /* Specific modal styles */
.name-sorter-modal .modal-content { max-width: 450px; }
.name-sorter-modal #sorter-result-display { min-height: 60px; background-color: var(--bg-tertiary); border: 1px dashed var(--border-color); border-radius: 5px; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 1rem; margin-bottom: 1rem; font-size: 1.4rem; font-weight: bold; text-align: center; word-break: break-word; }
.name-sorter-modal .sorter-controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: space-between; margin-bottom: 1rem;}
.name-sorter-modal .sorter-info { font-size: 0.8rem; color: var(--text-secondary); }
.timer-modal .modal-content { max-width: 400px; }
.timer-modal #timer-display { font-size: 3rem; font-weight: bold; text-align: center; margin-bottom: 1.5rem; background-color: var(--bg-tertiary); padding: 1rem; border-radius: 5px; font-family: monospace; }
.timer-modal .timer-controls { display: flex; justify-content: space-around; gap: 10px; }
.timer-modal .timer-controls button { flex-grow: 1; }
/* Group Generator Modal */
.group-generator-modal .modal-content { max-width: 90%; width: auto; }
.group-generator-modal .group-options { display: flex; flex-wrap: wrap; gap: 15px; align-items: center; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color);}
.group-generator-modal .group-options .radio-group { display: flex; align-items: center; gap: 5px; margin-bottom: 0; }
.group-generator-modal .group-options input[type="radio"] { width: auto; margin: 0; }
.group-generator-modal .group-options label { margin-bottom: 0; }
.group-generator-modal .group-options input[type="number"] { width: 70px; margin-bottom: 0; padding: 0.4rem; font-size: 0.9rem; }
.group-generator-modal #group-results-container { margin-top: 1rem; max-height: 50vh; overflow-y: auto; padding-right: 5px;}
.group-generator-modal .generated-group { margin-bottom: 1rem; padding: 0.8rem; border: 1px solid var(--border-color); border-radius: 5px; background-color: var(--bg-tertiary-alpha); }
.group-generator-modal .generated-group h5 { margin-bottom: 0.5rem; font-size: 1rem; color: var(--accent-primary); }
.group-generator-modal .generated-group ul { list-style: none; padding-left: 0; }
.group-generator-modal .generated-group li { font-size: 0.9rem; margin-bottom: 0.3rem; display: flex; align-items: baseline; }
.group-generator-modal .generated-group li .student-number { font-weight: bold; margin-right: 6px; min-width: 20px; text-align: right; font-size: 0.8em; color: var(--text-secondary); }
/* Advanced Calculator Modal */
.calculator-modal .modal-content { max-width: 380px; padding: 10px; }
.calculator-mode-selector { display: flex; gap: 5px; margin-bottom: 10px; }
.calculator-mode-selector button { flex: 1; font-size: 0.85rem; padding: 0.4rem 0.6rem; background-color: var(--calc-mode-button-bg); color: var(--calc-mode-button-text); border: 1px solid var(--border-color); }
.calculator-mode-selector button.active { background-color: var(--calc-mode-button-active-bg); color: var(--calc-mode-button-active-text); border-color: var(--calc-mode-button-active-bg); }
.calculator-display { width: 100%; background-color: var(--calc-display-bg); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 5px; padding: 10px 15px; font-size: 2rem; text-align: right; margin-bottom: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-height: 60px; display: flex; align-items: center; justify-content: flex-end; }
.calculator-buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-bottom: 10px; }
.calculator-buttons button { padding: 0.8rem; font-size: 1.1rem; margin: 0; border: 1px solid transparent; background-color: var(--calc-button-bg); color: var(--calc-button-text); transition: background-color 0.2s ease, opacity 0.2s ease, transform 0.1s ease; }
.calculator-buttons button:hover { opacity: var(--calc-button-hover-opacity); }
.calculator-buttons button:active { transform: scale(var(--calc-button-active-scale)); }
.calculator-buttons button.num { background-color: var(--calc-button-bg); color: var(--calc-button-text); }
.calculator-buttons button.op { background-color: var(--calc-op-button-bg); }
.calculator-buttons button.util { background-color: var(--calc-util-button-bg); }
.calculator-buttons button.danger { background-color: var(--calc-danger-button-bg); }
.calculator-buttons button.warn { background-color: var(--calc-warn-button-bg); }
.calculator-buttons button.eq { background-color: var(--accent-success); }
.calculator-buttons button.zero { grid-column: span 2; }
.calculator-buttons button.disabled { opacity: 0.5; cursor: not-allowed; background-color: var(--accent-secondary) !important; }
.weighted-average-section { padding-top: 10px; border-top: 1px solid var(--border-color); }
.weighted-average-section h5 { font-size: 1rem; margin-bottom: 0.8rem; text-align: center; color: var(--text-secondary); }
.grade-weight-input-group { display: flex; gap: 8px; margin-bottom: 0.8rem; }
.grade-weight-input-group input[type="number"] { margin-bottom: 0; padding: 0.5rem; font-size: 0.9rem; text-align: center; width: 40%; }
.grade-weight-input-group button { padding: 0.5rem 0.8rem; font-size: 0.9rem; width: auto; flex-shrink: 0; margin: 0; }
.pairs-list { list-style: none; padding: 8px; margin-bottom: 0.8rem; max-height: 150px; overflow-y: auto; background-color: var(--bg-tertiary-alpha); border: 1px dashed var(--border-color); border-radius: 5px; }
.pairs-list p { font-size: 0.8rem; color: var(--text-secondary); text-align: center; margin: 1rem 0; }
.pair-item { display: flex; justify-content: space-between; align-items: center; background-color: var(--bg-secondary-alpha); padding: 5px 8px; border-radius: 4px; margin-bottom: 5px; font-size: 0.9rem; border: 1px solid var(--border-color); }
.pair-item span { flex-grow: 1; }
.pair-item button { padding: 0.1rem 0.4rem; font-size: 0.8rem; line-height: 1; margin-left: 8px; }
.weighted-average-result { margin-top: 0.5rem; font-weight: bold; text-align: center; background-color: var(--bg-tertiary); padding: 8px; border-radius: 5px; min-height: 30px; }
.weighted-average-section button.calculate { width: 100%; }

.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; margin-bottom: 15px; flex-shrink: 0; }
.modal-header h2 { margin: 0; font-size: 1.2rem; text-align: left; justify-content: flex-start; gap: 0; }
.close-button { background: none; border: none; font-size: 1.8rem; font-weight: bold; color: var(--text-secondary); cursor: pointer; padding: 0 0.5rem; line-height: 1; }
.close-button:hover { color: var(--text-primary); }
.modal-body { overflow-y: auto; flex-grow: 1; padding-right: 5px; padding-bottom: 5px; /* Remove explicit padding if calc modal needs full space */ }
 .calculator-modal .modal-body { padding: 0 5px 5px 5px; } /* Adjust calculator padding */
.modal-body form { margin-bottom: 0; }
.modal-body textarea { min-height: 150px; }
.modal-footer { border-top: 1px solid var(--border-color); padding-top: 10px; margin-top: 15px; text-align: right; flex-shrink: 0; display: flex; justify-content: flex-end; gap: 5px; }
.modal-footer button { margin-left: 0; }
@keyframes modalFadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes modalSlideIn { from { transform: translateY(-25px) scale(0.98); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }
.justification-modal .modal-body textarea { min-height: 200px; } /* Ajustado de 250px */
.text-sm { font-size: 0.8rem; }

/* Tabela de Dados */
.table-scroll-wrapper { width: 100%; overflow-x: auto; margin-top: 0.5rem; -webkit-overflow-scrolling: touch; border: 1px solid var(--border-color); border-radius: 5px; background-color: var(--bg-primary); }
.data-table { width: 100%; min-width: 280px; border-collapse: collapse; font-size: 0.85rem; table-layout: fixed; word-wrap: break-word; border: none; }
.data-table th, .data-table td { border: 1px solid var(--border-color); padding: 0.5rem 0.4rem; text-align: left; vertical-align: middle; white-space: nowrap; }
.data-table th { background-color: var(--bg-tertiary); font-weight: 600; position: sticky; top: 0; z-index: 2; font-size: 0.8rem; }
.data-table th:first-child, .data-table td:first-child { position: sticky; left: 0; z-index: 1; background-color: var(--bg-sticky-alpha); border-right: 1px solid var(--border-color); white-space: normal; }
.data-table th:first-child { z-index: 3; }
.data-table td input[type="number"], .data-table td select { padding: 0.3rem; margin-bottom: 0; font-size: 0.85rem; width: 55px; max-width: 100%; border-radius: 3px; text-align: center; border: 1px solid var(--input-border); background-color: var(--input-bg); color: var(--text-primary); }
.data-table td input.grade-input { transition: background-color 0.3s ease, color 0.3s ease; }
.data-table td select { width: 80px; }
.data-table td button { padding: 0.2rem 0.4rem; font-size: 0.75rem; margin: 0 1px; min-width: 30px; }
.data-table td textarea { display: none; }

/* --- ATTENDANCE TABLE --- */
#attendance-table-container .data-table .attendance-status { width: 90px; text-align: center; vertical-align: middle; flex-shrink: 0; border-left: none; }
#attendance-table-container .data-table .attendance-status.status-H { font-weight: bold; font-style: italic; color: var(--attendance-holiday-text); background-color: var(--attendance-holiday-bg); cursor: default; text-align: center;}
#attendance-table-container .data-table .student-col { width: auto; min-width: 160px; white-space: normal; word-break: break-word; display: flex; align-items: center; gap: 5px; padding-left: 0.6rem; border-right: none; }
#attendance-table-container .data-table th.attendance-status { text-align: center; border-left: none;}
#attendance-table-container .data-table th.student-col { text-align: left; padding-left: 0.6rem;}
#attendance-table-container .data-table .student-col .student-number { flex-shrink: 0; min-width: 20px; text-align: right; font-weight: bold; font-size: 0.8rem; }
#attendance-table-container .data-table .student-col .student-name { flex-grow: 1; white-space: normal; word-break: break-word; font-size: 0.85rem; }

/* --- GRADES TABLE --- */
#grades-table-container .data-table .grade-col { width: 55px; text-align: center; }
#grades-table-container .data-table .sum-col { width: 60px; text-align: center; }
#grades-table-container .data-table .avg-col { width: 60px; text-align: center; font-weight: bold; transition: background-color 0.3s ease, color 0.3s ease; }
#grades-table-container .data-table .student-col { width: 120px; min-width: 100px; white-space: normal; word-break: break-word; border-right: 2px solid var(--border-color); }
.data-table td.average.grade-low { background-color: var(--grade-low-bg); color: var(--grade-low-text); }
.data-table td.average.grade-medium { background-color: var(--grade-medium-bg); color: var(--grade-medium-text); }
.data-table td.average.grade-high { background-color: var(--grade-high-bg); color: var(--grade-high-text); }

/* Attendance Buttons Styling */
.attendance-toggle { padding: 0.3rem 0.45rem; margin: 0 1px; font-size: 0.8rem; font-weight: 600; opacity: 0.7; border: 2px solid transparent; min-width: 34px; transition: all 0.2s cubic-bezier(0.68, -0.55, 0.27, 1.55); display: inline-flex; align-items: center; justify-content: center; gap: 0.2em; line-height: 1; vertical-align: middle; }
#attendance-table-container .data-table .attendance-status { text-align: center; white-space: nowrap; }
.attendance-toggle .icon { margin-right: 0; font-size: 0.9em; }
.attendance-toggle.selected { opacity: 1; border-width: 2px; border-style: solid; transform: scale(1.05); }
.attendance-toggle.present.selected { background-color: var(--accent-success); border-color: var(--accent-success); color: #fff; }
.attendance-toggle.absent.selected:not(.justified) { background-color: var(--accent-danger); border-color: var(--accent-danger); color: #fff; }
.attendance-toggle.absent.justified.selected { background-color: var(--accent-warning); border-color: var(--accent-warning); }
.attendance-toggle:disabled { opacity: 0.4 !important; cursor: not-allowed !important; background-color: transparent !important; border-color: transparent !important; transform: none !important; color: var(--text-secondary) !important; }

/* --- Attendance Actions Container --- */
.attendance-actions-container { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 8px; margin-top: 0.5rem; margin-bottom: 0.8rem; }
.attendance-actions-container button { margin: 0; padding: 0.4rem 0.7rem; font-size: 0.8rem; flex-grow: 1; flex-basis: 0; max-width: 50%; white-space: nowrap; }
.attendance-actions-container button .icon { margin-right: 0.3em; }

/* --- Monthly Attendance --- */
#monthly-attendance-controls { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 10px; margin-bottom: 0.5rem; }
#monthly-attendance-controls .date-selectors { display: flex; align-items: center; gap: 5px; flex-wrap: wrap; }
#monthly-attendance-controls label { margin-bottom: 0; }
#monthly-attendance-controls select { width: auto; padding: 0.4rem; font-size: 0.9rem; margin-bottom: 0; }
#monthly-attendance-controls .export-buttons { display: flex; gap: 5px; }
#monthly-attendance-table-wrapper { max-height: 60vh; overflow: auto; margin-top: 10px; }
.monthly-attendance-table { width: 100%; min-width: 800px; border-collapse: collapse; font-size: 0.75rem; }
.monthly-attendance-table th, .monthly-attendance-table td { border: 1px solid var(--border-color); padding: 0.3rem; text-align: center; min-width: 32px; white-space: nowrap; }
.monthly-attendance-table th { background-color: var(--bg-tertiary); font-weight: 600; }
.monthly-attendance-table th.student-col-monthly, .monthly-attendance-table td.student-col-monthly { min-width: 150px; text-align: left; position: sticky; left: 0; background-color: var(--bg-sticky-alpha); z-index: 1; white-space: normal; border-right: 2px solid var(--border-color); }
.monthly-attendance-table th.student-col-monthly { z-index: 3; }
.monthly-attendance-table th.freq-col-monthly, .monthly-attendance-table td.freq-col-monthly { min-width: 50px; font-weight: bold; position: sticky; right: 0; background-color: var(--bg-sticky-alpha); z-index: 1; border-left: 2px solid var(--border-color); }
 .monthly-attendance-table th.freq-col-monthly { z-index: 3; }
.monthly-attendance-table td.weekend { background-color: var(--bg-tertiary-alpha); opacity: 0.7; cursor: default; } /* Ajuste: cursor padrão */
.monthly-attendance-table td.status-H { background-color: var(--attendance-holiday-bg); color: var(--attendance-holiday-text); font-style: italic; font-weight: bold; }
#monthly-attendance-summary { margin-top: 1rem; text-align: center; font-weight: bold; }
#monthly-attendance-chart-container { margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid var(--border-color); display: flex; flex-wrap: nowrap; /* Não quebrar linha */ gap: 5px; align-items: flex-end; min-height: 100px; overflow-x: auto; /* Rolagem horizontal */ padding-bottom: 10px; -webkit-overflow-scrolling: touch; }
.chart-bar-container { display: flex; flex-direction: column; align-items: center; flex: 0 0 auto; min-width: 40px; text-align: center; }
.chart-bar { width: 25px; background-color: var(--accent-primary); border-radius: 3px 3px 0 0; transition: height 0.3s ease-out; position: relative; }
 .chart-bar::after { content: attr(data-percentage); position: absolute; top: -1.5em; left: 50%; transform: translateX(-50%); background-color: rgba(0,0,0,0.7); color: white; padding: 2px 5px; border-radius: 3px; font-size: 0.7rem; white-space: nowrap; opacity: 0; transition: opacity 0.2s; pointer-events: none; z-index: 5; }
 .chart-bar:hover::after { opacity: 1; }
.chart-label { font-size: 0.7rem; margin-top: 3px; color: var(--text-secondary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 50px; }

/* --- Student Observations --- */
#student-observations-list { max-height: 45vh; overflow-y: auto; margin-bottom: 1rem; border: 1px solid var(--border-color); border-radius: 5px; padding: 0.5rem; background-color: var(--bg-tertiary-alpha); }
.observation-item { background-color: var(--bg-secondary-alpha); border: 1px solid var(--border-color); border-radius: 4px; padding: 0.6rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: flex-start; gap: 10px; }
.observation-item .observation-details { flex-grow: 1; }
.observation-item .observation-date { font-size: 0.75rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.25rem; display: block; }
.observation-item .observation-text { font-size: 0.9rem; white-space: pre-wrap; word-break: break-word; }
.observation-item .delete-observation-button { flex-shrink: 0; padding: 0.2rem 0.4rem; font-size: 0.8rem; margin-left: 5px; background-color: var(--accent-danger); color: #fff; border: none; }
 #add-observation-section { margin-top: 1rem; border-top: 1px solid var(--border-color); padding-top: 1rem; }
 #add-observation-section label { margin-bottom: 0.3rem; font-size: 0.9rem; }
 #new-observation-text { min-height: 80px; margin-bottom: 0.5rem; font-size: 0.95rem; }
 #add-observation-button { width: 100%; }

/* Ajustes específicos */
#save-grades-button, #save-attendance-button, #save-lesson-plan-button, #save-monthly-attendance-button, #save-map-button { margin-top: 0.8rem !important; }
.fab-button { position: fixed; bottom: calc(var(--nav-height) + var(--fab-bottom-margin)); right: 20px; width: 50px; height: 50px; border-radius: 50%; font-size: 1.8rem; line-height: 1; box-shadow: 0 4px 10px var(--shadow-color); z-index: 1010; transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s ease; }
.fab-button:active { transform: scale(0.9); opacity: var(--active-opacity); }
#classes-section h2, #class-details-section h2 { color: var(--accent-primary); font-size: 1.3rem; margin-bottom: 1rem; display: flex; align-items: center; position: relative; text-align: center; justify-content: center; padding-left: 45px; padding-right: 45px; gap: 0.5em; }
#classes-section h2 .back-button, #class-details-section h2 .back-button { position: absolute; left: 0; top: 50%; transform: translateY(-50%); margin-right: 0; padding: 0.3rem 0.6rem; font-size: 1rem; }
#classes-section h2 span:not(.icon):not(.back-button), #class-details-section h2 span:not(.icon):not(.back-button) { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex-grow: 1; text-align: center; }
.icon { display: inline-block; font-style: normal; font-variant: normal; text-rendering: auto; -webkit-font-smoothing: antialiased; margin-right: 0; line-height: 1; flex-shrink: 0; }
.icon-only { margin-right: 0 !important; }
.icon-horario::before { content: "🕒"; font-size: 1.1em; } .icon-escola::before { content: "🏫"; font-size: 1.1em; } .icon-turmas::before { content: "📚"; font-size: 1.1em; } .icon-alunos::before { content: "🧑‍🎓"; font-size: 1.1em; } .icon-notas::before { content: "📊"; font-size: 1.1em; } .icon-config::before { content: "⚙️"; font-size: 1.1em; } .icon-contato::before { content: "✉️"; font-size: 1.1em; } .icon-editar::before { content: "✏️"; } .icon-excluir::before { content: "🗑️"; } .icon-anotacao::before { content: "📝"; } .icon-salvar::before { content: "💾"; } .icon-voltar::before { content: "⬅️"; } .icon-presenca::before { content: "✔️"; } .icon-falta::before { content: "❌"; } .icon-justificar::before { content: "💬"; } .icon-adicionar::before { content: "➕"; font-size: 1.1em; } .icon-estrutura::before { content: "🧱"; } .icon-calendario::before { content: "📅"; } .icon-plano::before { content: "🗒️"; } .icon-copiar::before { content: "📋"; } .icon-pdf::before { content: "📄"; font-size: 1.0em;}
.icon-mover::before { content: "🔁"; font-size: 1.0em; }
.icon-todos-presentes::before { content: "👥✔️"; font-size: 1.0em; }
.icon-notificacao-on::before { content: "🔔"; font-size: 1em; color: var(--accent-warning); }
.icon-notificacao-off::before { content: "🔕"; font-size: 1em; color: var(--text-secondary); opacity: 0.6; }
.icon-nao-letivo::before { content: "🏖️"; font-size: 1.0em; }
 .icon-mapa::before { content: "🗺️"; font-size: 1.1em; }
 .icon-chevron-down::before { content: "▼"; font-size: 0.8em; }
 .icon-chevron-up::before { content: "▲"; font-size: 0.8em; }
 .icon-som::before { content: "🔊"; font-size: 1em; }
 .icon-arquivo::before { content: "📁"; font-size: 1em; }
 /* Tool Icons */
 .icon-ferramentas::before { content: "🔧"; font-size: 1.1em; }
 .icon-sorteio::before { content: "🎲"; font-size: 1.3em; }
 .icon-cronometro::before { content: "⏱️"; font-size: 1.3em; }
 .icon-grupos::before { content: "👨‍👩‍👧‍👦"; font-size: 1.3em; }
 .icon-calculadora-avancada::before { content: "🧮"; font-size: 1.3em; }

.hidden { display: none !important; } .text-center { text-align: center; } .text-right { text-align: right; } .mt-1 { margin-top: 0.5rem; } .mt-2 { margin-top: 1rem; } .mb-0 { margin-bottom: 0; } .mb-1 { margin-bottom: 0.5rem; } .mb-2 { margin-bottom: 1rem; } .mr-1 { margin-right: 0.5rem; } .ml-1 { margin-left: 0.5rem; } .d-flex { display: flex; } .justify-between { justify-content: space-between; } .align-center { align-items: center; } .w-100 { width: 100%; }
.list-item.active { background-color: var(--bg-tertiary-alpha); border-left: 4px solid var(--accent-primary); }

/* Schedule List specific styles */
.schedule-day-group { margin-bottom: 1.5rem; }
.schedule-day-title { font-size: 1.2rem; font-weight: 600; color: var(--accent-primary); margin-bottom: 0.5rem; padding-bottom: 0.3rem; border-bottom: 2px solid var(--accent-primary); text-align: left; justify-content: flex-start; gap: 0; }
.schedule-item { display: flex; align-items: center; padding: 0.6rem 0.8rem; background-color: var(--bg-secondary-alpha); border: 1px solid var(--border-color); border-radius: 5px; margin-bottom: 0.5rem; }
.schedule-time { font-weight: 600; width: 100px; flex-shrink: 0; }
.schedule-info { flex-grow: 1; margin: 0 0.8rem; }
.schedule-info .school-name { font-weight: 500; }
.schedule-info .note { font-size: 0.8rem; color: var(--text-secondary); }
.schedule-actions { flex-shrink: 0; display: flex; align-items: center; gap: 4px;}
.schedule-actions button { padding: 0.2rem 0.4rem; font-size: 0.8rem; }
.notification-toggle-button { padding: 0.2rem 0.3rem !important; font-size: 1rem !important; background: transparent !important; border: none !important; cursor: pointer; }
.notification-toggle-button:hover { opacity: 0.7; }

/* --- Grade Structure Modal Styles --- */
.grade-structure-modal .card { padding: 0.8rem; margin-bottom: 0.8rem; }
.grade-structure-modal .card-header { padding-bottom: 0.4rem; margin-bottom: 0.4rem; align-items: flex-start; gap: 8px; }
.grade-structure-modal .gs-name { font-size: 1.05rem; margin-bottom: 0 !important; flex-grow: 1; padding: 0.5rem; }
.grade-structure-modal .delete-gs-button { margin-left: auto; flex-shrink: 0; }
.grade-structure-modal .gs-section { border-top: 1px solid var(--border-color); margin-top: 0.8rem; padding-top: 0.8rem; }
.grade-structure-modal .gs-section h4 { font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 0.6rem; font-weight: 500; }
.grade-structure-modal .gs-instruments-container { padding-top: 0rem; }
.grade-label-item { display: flex; align-items: center; margin-bottom: 0.5rem; gap: 5px; }
.grade-label-item input { flex-grow: 1; margin-right: 0; margin-bottom: 0; font-size: 0.95rem; padding: 0.5rem; }
.grade-label-item button { flex-shrink: 0; }
.grade-structure-modal .add-gs-label-button { font-size: 0.85rem !important; padding: 0.3rem 0.8rem !important; margin-top: 0.5rem !important; }
#add-grade-set-button { width: 100%; margin-top: 0.5rem; }
/* Color Range Styles */
.color-range-item { display: flex; align-items: center; gap: 8px; margin-bottom: 0.6rem; border: 1px dashed var(--border-color); padding: 0.5rem; border-radius: 4px; flex-wrap: wrap; }
.color-range-item label { margin-bottom: 0; font-size: 0.85rem; flex-shrink: 0;}
.color-range-item input[type="number"] { width: 65px; padding: 0.4rem; margin-bottom: 0; font-size: 0.9rem; text-align: center;}
.color-range-item input[type="color"] { width: 40px; height: 30px; padding: 2px; margin-bottom: 0;}
.color-range-item button { flex-shrink: 0; margin-left: auto; }
.grade-structure-modal .add-color-range-button { font-size: 0.85rem !important; padding: 0.3rem 0.8rem !important; margin-top: 0.3rem !important; display: block; margin-left: auto; margin-right: auto; }

/* --- Notas e Médias Header Adjustment --- */
 #class-details-section > .card:nth-of-type(4) .card-header .options { display: flex; align-items: center; flex-wrap: wrap; gap: 5px; margin-left: auto; }
 #class-details-section > .card:nth-of-type(4) .card-header .options label { margin-bottom: 0; font-size: 0.85rem; white-space: nowrap; margin-right: 2px; }
 #class-details-section > .card:nth-of-type(4) .card-header .options select { padding: 0.3rem 0.4rem; font-size: 0.85rem; margin-bottom: 0; flex-shrink: 0; margin-right: 5px; }
 #class-details-section > .card:nth-of-type(4) .card-header .options button.icon-button { margin-left: 0; margin-right: 5px; }
 #class-details-section > .card:nth-of-type(4) .card-header .options .export-buttons { display: flex; gap: 5px; margin-left: 0; }

/* --- Class Notes Area Adjustment --- */
 #class-notes-edit textarea { min-height: 120px; margin-bottom: 0.5rem;}
 #class-notes-edit .text-right { margin-bottom: 0.5rem; margin-top: 0; }
/* --- Lesson Plan Area --- */
#lesson-plan-textarea { min-height: 100px; margin-bottom: 0.5rem; }

.footer-message { text-align: center; font-size: 0.85rem; color: var(--text-secondary); margin-top: 2rem; margin-bottom: 1rem; padding: 0 1rem; }
#contact-section .card p { margin-bottom: 1rem; }
#contact-section .card a { font-weight: 500; word-break: break-all; }
#contact-section .card h4 { font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }

/* Estilos para Chave PIX e Botão Copiar */
.pix-key-container { background-color: var(--bg-tertiary-alpha); padding: 0.8rem; border-radius: 5px; font-family: monospace, 'Courier New', Courier; word-break: break-all; margin-top: 0.5rem; margin-bottom: 1rem; border: 1px dashed var(--border-color); user-select: all; cursor: text; }
#copy-pix-button { width: 100%; max-width: 300px; margin: 0 auto; display: flex; gap: 0.5em; background-color: var(--accent-success); transition: background-color 0.3s ease; }
#copy-pix-button.error { background-color: var(--accent-danger); }

/* --- Notification Banner Styles --- */
#notification-banner { position: fixed; top: 0; left: 0; width: 100%; background-color: var(--bg-notification); color: var(--text-notification); padding: 10px 15px; z-index: 2000; box-shadow: 0 2px 5px rgba(0,0,0,0.2); display: flex; justify-content: space-between; align-items: center; transform: translateY(-120%); transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); font-size: 0.9rem; line-height: 1.3; }
#notification-banner.show { transform: translateY(0); }
#notification-message { flex-grow: 1; margin-right: 10px; }
#notification-close-button { background: none; border: none; color: inherit; opacity: 0.8; font-size: 1.6rem; font-weight: bold; cursor: pointer; padding: 0 5px; line-height: 1; }
#notification-close-button:hover { opacity: 1; }

/* --- Settings: Custom Notification Sound Styles --- */
.custom-sound-container { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
.custom-sound-input-group { display: flex; align-items: center; gap: 10px; margin-bottom: 0.5rem; flex-wrap: wrap; }
#custom-sound-filename { font-size: 0.85rem; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex-grow: 1; background: var(--bg-tertiary-alpha); padding: 0.4rem 0.6rem; border-radius: 4px; border: 1px solid var(--border-color); min-width: 100px; }
#current-custom-sound-display { border: 1px dashed var(--border-color); background-color: var(--bg-tertiary-alpha); padding: 0.5rem; border-radius: 4px; margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-secondary); display: flex; align-items: center; justify-content: space-between; }
#current-custom-sound-name { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: calc(100% - 40px); }
#remove-custom-sound-button { padding: 0.3rem 0.5rem; font-size: 0.8rem; flex-shrink: 0; }

/* --- Classroom Map Styles (FINAL - Grid Layout & Desk Alignment v4) --- */
.classroom-container { display: grid; grid-template-rows: auto 1fr auto; grid-template-columns: auto 1fr auto; gap: 10px; padding: 15px; border: 1px solid var(--border-color); border-radius: 5px; margin-top: 1rem; overflow: auto; align-items: center; justify-items: center; min-height: 200px; }
.classroom-map-grid { grid-area: 2 / 2 / 3 / 3; display: grid; gap: var(--seat-gap); justify-content: center; padding: 5px; width: fit-content; max-width: 100%; }
.seat { width: var(--seat-width); height: var(--seat-height); border: 2px solid var(--map-seat-border); background-color: var(--map-seat-bg); border-radius: 5px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; font-size: 0.7rem; color: var(--map-seat-text); overflow: hidden; cursor: default; position: relative; transition: background-color 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease; }
.seat.occupied { background-color: var(--map-seat-occupied-bg); color: var(--map-seat-occupied-text); font-weight: 500; border-style: solid; }
.map-edit-area .seat.occupied { cursor: pointer; }
.map-edit-area .seat.empty { cursor: pointer; }
.map-edit-area .seat.occupied[draggable="true"] { cursor: grab; }
.map-edit-area .seat.occupied[draggable="true"]:active { cursor: grabbing; }
.seat.occupied .seat-student-number { font-size: 0.65rem; opacity: 0.8; display: block; line-height: 1; margin-bottom: 2px; pointer-events: none; }
.seat.occupied .seat-student-name { display: block; line-height: 1.1; max-height: 2.2em; overflow: hidden; padding: 0 2px; pointer-events: none; }
.seat.empty::before { display: none; }
.seat.empty .seat-placeholder-text { font-size: 0.65rem; line-height: 1.1; padding: 2px; display: block; opacity: 0.6; color: var(--map-seat-text); }
.seat span.seat-placeholder-text { display: none; } /* Esconde span vazio por padrão */
.seat.empty span.seat-placeholder-text { display: block; } /* Mostra span se for .empty */
.teacher-desk { border: var(--teacher-desk-border-width) solid var(--map-teacher-desk-border); background-color: var(--map-teacher-desk-bg); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: var(--text-primary); z-index: 5; transition: transform 0.3s, width 0.3s, height 0.3s, grid-area 0s; width: var(--teacher-desk-width); height: var(--teacher-desk-height); transform-origin: center center; margin: 0; }
.teacher-desk.position-top-center    { grid-area: 1 / 2 / 2 / 3; }
.teacher-desk.position-bottom-center { grid-area: 3 / 2 / 4 / 3; }
.teacher-desk.position-left-center   { grid-area: 2 / 1 / 3 / 2; transform: rotate(-90deg); }
.teacher-desk.position-right-center  { grid-area: 2 / 3 / 3 / 4; transform: rotate(90deg); }
.teacher-desk.position-top-left   { grid-area: 1 / 2 / 2 / 3; justify-self: start; }
.teacher-desk.position-top-right  { grid-area: 1 / 2 / 2 / 3; justify-self: end;   }
.teacher-desk.position-bottom-left   { grid-area: 3 / 2 / 4 / 3; justify-self: start; }
.teacher-desk.position-bottom-right  { grid-area: 3 / 2 / 4 / 3; justify-self: end;   }
.teacher-desk.position-left-top    { grid-area: 2 / 1 / 3 / 2; align-self: start; transform: rotate(-90deg); }
.teacher-desk.position-left-bottom { grid-area: 2 / 1 / 3 / 2; align-self: end;   transform: rotate(-90deg); }
.teacher-desk.position-right-top    { grid-area: 2 / 3 / 3 / 4; align-self: start; transform: rotate(90deg); }
.teacher-desk.position-right-bottom { grid-area: 2 / 3 / 3 / 4; align-self: end;   transform: rotate(90deg); }
.classroom-map-edit-controls { display: flex; flex-wrap: wrap; gap: 15px; align-items: center; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); }
.classroom-map-edit-controls .form-group { margin-bottom: 0; display: flex; align-items: center; gap: 5px;}
.classroom-map-edit-controls label { margin-bottom: 0; flex-shrink: 0; }
.classroom-map-edit-controls input[type="number"], .classroom-map-edit-controls select { width: auto; max-width: 80px; margin-bottom: 0; padding: 0.4rem; font-size: 0.9rem; }
.classroom-map-edit-controls select { max-width: 140px; }
.map-edit-area { display: flex; gap: 20px; margin-top: 1rem; flex-wrap: wrap; }
.unassigned-students-list { border: 1px dashed var(--map-seat-border); padding: 10px; border-radius: 5px; min-height: 100px; max-height: 40vh; overflow-y: auto; background-color: var(--bg-tertiary-alpha); flex: 1; min-width: 180px; }
.unassigned-students-list h5 { margin-bottom: 0.5rem; font-size: 0.9rem; text-align: center; color: var(--text-secondary); }
 .draggable-student { background-color: var(--map-seat-occupied-bg); color: var(--map-seat-occupied-text); padding: 5px 8px; border: 1px solid var(--map-seat-border); border-radius: 4px; margin-bottom: 5px; font-size: 0.8rem; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; user-select: none; }
 .draggable-student[draggable="true"]:active { cursor: grabbing; }
 .draggable-student .student-number { font-weight: bold; margin-right: 4px; pointer-events: none; }
 .draggable-student .student-name { pointer-events: none; }
 .seat.drag-over { border-color: var(--accent-success); background-color: var(--map-drag-over-bg); box-shadow: 0 0 8px var(--map-drag-over-bg); }
 .unassigned-students-list.drag-over { border-color: var(--accent-danger); background-color: color-mix(in srgb, var(--accent-danger) 15%, transparent); }
 .seat.occupied.dragging, .draggable-student.dragging { opacity: 0.4; }
 .seat.selected-for-assignment { border-color: var(--map-seat-selected-border); box-shadow: 0 0 0 3px color-mix(in srgb, var(--map-seat-selected-border) 40%, transparent); }

/* --- Tools Grid --- */
.tools-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(var(--tool-card-min-width), 1fr)); gap: 1rem; padding: 0.5rem 0; }
.tool-card { background-color: var(--bg-secondary-alpha); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.2rem 0.8rem; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease; box-shadow: 0 2px 4px var(--shadow-color); min-height: 100px; }
.tool-card:hover { transform: translateY(-3px); box-shadow: 0 6px 12px color-mix(in srgb, var(--shadow-color) 120%, black); }
.tool-card:active { transform: scale(0.97); background-color: var(--bg-tertiary-alpha); } /* Feedback de toque */
.tool-card .icon { font-size: 2rem; margin-bottom: 0.6rem; color: var(--accent-primary); }
.tool-card-title { font-size: 0.9rem; font-weight: 500; color: var(--text-primary); line-height: 1.3; }

/* Estilo para botões de tema selecionado */
#theme-selector .theme-button[style*="border"] {
    border-width: 2px !important; /* Garante a largura */
    border-style: solid !important; /* Garante o estilo */
}